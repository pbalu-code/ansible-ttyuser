---
# This is an example playbook to execute Ansible tests.

- name: Verify
  hosts: all
  become: true
  tasks:
    # We run the BATS tests from the localhost, since they are black box tests
    - name: "Run BATS tests for {{ ansible_hostname }}"
      shell: >
        SUT_IP={{ ansible_default_ipv4.address }}
        ../tests/libs/bats/bin/bats --tap {{ playbook_dir }}/../tests/test_bats.bats
      register: bats_test
      delegate_to: localhost
      changed_when: false
